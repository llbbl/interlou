{{ define "main" }}
<div class="photos-grid">
  {{ $photos := where .Site.RegularPages "Section" "photos" }}
  {{ range $photos }}
    {{ $images := .Resources.ByType "image" }}
    {{ if $images }}
      {{ range $images }}
      <a href="{{ .RelPermalink }}" class="photo-item" target="_blank">
        <img src="{{ .RelPermalink }}" alt="{{ $.Title }}" loading="lazy">
      </a>
      {{ end }}
    {{ else }}
      {{/* Fallback: extract images from content */}}
      {{ $content := .Content }}
      {{ range findRE `<img[^>]+src="([^"]+)"` $content }}
        {{ $src := replaceRE `.*src="([^"]+)".*` "$1" . }}
        <a href="{{ $src }}" class="photo-item" target="_blank">
          <img src="{{ $src }}" alt="{{ $.Title }}" loading="lazy">
        </a>
      {{ end }}
    {{ end }}
  {{ end }}
</div>
{{ end }}
